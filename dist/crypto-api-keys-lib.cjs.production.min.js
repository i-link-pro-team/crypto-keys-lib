"use strict";function e(e){return e&&"object"==typeof e&&"default"in e?e.default:e}Object.defineProperty(exports,"__esModule",{value:!0});var t,r,i,n=require("sodium-plus"),o=e(require("create-hash")),s=require("bip39"),a=e(require("base-x")),c=require("bitcoinjs-lib"),u=require("bip32"),h=e(require("bech32")),f=require("bchaddrjs"),p=require("ethereumjs-util"),l=require("eosjs-ecc"),d=require("ripple-keypairs"),g=require("ripple-address-codec");function k(){return(k=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e}).apply(this,arguments)}function m(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,e.__proto__=t}(t=exports.Blockchain||(exports.Blockchain={})).BITCOIN="bitcoin",t.ETHEREUM="ethereum",t.EOS="eos",t.BITCOIN_CASH="bitcoin_cash",t.BITCOIN_SV="bitcoin_sv",t.LITECOIN="litecoin",t.RIPPLE="ripple",(r=exports.Network||(exports.Network={})).MAINNET="mainnet",r.TESTNET="testnet",(i=exports.SeedDictionaryLang||(exports.SeedDictionaryLang={})).ENGLISH="english",i.JAPANESE="japanese",i.SPANISH="spanish",i.CHINESE_SIMPLE="chinese_simple",i.CHINESE_TRADITIONAL="chinese_traditional",i.FRENCH="french",i.ITALIAN="italian",i.KOREAN="korean",i.CZECH="czech";var b=function(e,t){if(e<0)throw Error("Skip must be greater or equal than zero");if(t<1)throw Error("Limit must be greater than zero");return Array.from({length:t},(function(t,r){return r+e+1}))},v=function(e){var t=e.split("/");return t.pop(),t.push("{index}"),t.join("/")},w=function(e){return e.split("/").filter((function(e){return"m"===e||-1!=e.indexOf("'")})).join("/")},x=a("123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"),P=function(e){return Buffer.from(o("sha256").update(e).digest())},N={mainnet:{messagePrefix:"Bitcoin Signed Message:\n",bech32:"bc",bip32:{public:76067358,private:76066276},pubKeyHash:0,scriptHash:5,wif:128},regtest:{messagePrefix:"Bitcoin Signed Message:\n",bech32:"bcrt",bip32:{public:70617039,private:70615956},pubKeyHash:111,scriptHash:196,wif:239},testnet:{messagePrefix:"Bitcoin Signed Message:\n",bech32:"tb",bip32:{public:70617039,private:70615956},pubKeyHash:111,scriptHash:196,wif:239}},y={mainnet:{messagePrefix:"Litecoin Signed Message:\n",bech32:"ltc",bip32:{public:76067358,private:76066276},pubKeyHash:48,scriptHash:50,wif:176},testnet:{messagePrefix:"Litecoin Signed Message:\n",bech32:"tltc",bip32:{public:70617039,private:70615956},pubKeyHash:111,scriptHash:196,wif:239}},E={mainnet:{messagePrefix:"unused",bech32:"bsv",bip32:{public:76067358,private:76066276},pubKeyHash:0,scriptHash:5,wif:128},testnet:{messagePrefix:"unused",bech32:"bsvtest",bip32:{public:70617039,private:70615956},pubKeyHash:111,scriptHash:196,wif:128}},S={0:{type:"p2pkh",network:"mainnet"},48:{type:"p2pkh",network:"mainnet"},111:{type:"p2pkh",network:"testnet"},5:{type:"p2sh",network:"mainnet"},196:{type:"p2sh",network:"testnet"}},T=function(e){try{return x.decode(e)}catch(e){return null}},I=function(e){try{return h.decode(e)}catch(e){return null}},A=function(){function e(e){var t;this.networks=((t={})[exports.Network.MAINNET]={blockchain:exports.Blockchain.BITCOIN,network:exports.Network.MAINNET,path:"m/44'/0'/0'",config:N.mainnet},t[exports.Network.TESTNET]={blockchain:exports.Blockchain.BITCOIN,network:exports.Network.TESTNET,path:"m/44'/1'/0'",config:N.testnet},t),this.networkConfig=this.networks[e].config,this.defaultPath=this.networks[e].path}var t=e.prototype;return t.getPaths=function(){return Object.values(this.networks).map((function(e){return{blockchain:e.blockchain,network:e.network,path:e.path}}))},t.deriveRecursive=function(e,t){if(t.length){var r=t[0],i=t.slice(1);return this.deriveRecursive(e.derive(r),i)}return e},t.getPrivateKey=function(e){return e.toWIF()},t.getPublicKey=function(e){return e},t.derivateFromPrivate=function(e,t){var r=this,i=u.fromBase58(e,this.networkConfig),n=b(t.skip,t.limit),o=v(t.path||this.defaultPath);return n.map((function(e){var t=o.replace("{index}",e.toString()),n=i.derivePath(t);return{path:t,address:r.getAddressFromPublic(r.getPublicKey(n.publicKey.toString("hex"))),publicKey:r.getPublicKey(n.publicKey.toString("hex")),privateKey:r.getPrivateKey(n)}}))},t.derivateFromPublic=function(e,t){var r=this,i=u.fromBase58(e,this.networkConfig),n=b(t.skip,t.limit),o=v(t.path||this.defaultPath);return n.map((function(e){var t=o.replace("{index}",e.toString()),n=t.replace(w(o),"").split("/").filter((function(e){return e})).map((function(e){return parseInt(e)})),s=r.deriveRecursive(i,n);return{path:t,address:r.getAddressFromPublic(r.getPublicKey(s.publicKey.toString("hex"))),publicKey:r.getPublicKey(s.publicKey.toString("hex"))}}))},t.sign=function(e,t,r){var i=c.ECPair.fromWIF(t,this.networkConfig),n=o("sha256").update(e).digest("hex");return i.sign(Buffer.from(n,"hex")).toString("hex")},t.checkSign=function(e,t,r){var i=c.ECPair.fromPublicKey(Buffer.from(e,"hex"),{network:this.networkConfig}),n=o("sha256").update(t).digest("hex");return i.verify(Buffer.from(n,"hex"),Buffer.from(r,"hex"))},t.getMasterAddressFromSeed=function(e,t){var r=u.fromSeed(Buffer.from(e,"hex"),this.networkConfig),i=r.derivePath(w(t||this.defaultPath));return{masterPrivateKey:r.toBase58(),masterPublicKey:r.neutered().toBase58(),masterAccountPrivateKey:i.toBase58(),masterAccountPublicKey:i.neutered().toBase58()}},t.getPublicFromPrivate=function(e,t){return void 0===t&&(t=!0),(t?c.ECPair.fromWIF(e,this.networkConfig):c.ECPair.fromPrivateKey(Buffer.from(e,"hex"))).publicKey.toString("hex")},t.getAddressFromPublic=function(e,t){var r,i;return t&&"bech32"===t?null!==(i=c.payments.p2wpkh({pubkey:Buffer.from(e,"hex"),network:this.networkConfig}).address)&&void 0!==i?i:"":null!==(r=c.payments.p2pkh({pubkey:Buffer.from(e,"hex"),network:this.networkConfig}).address)&&void 0!==r?r:""},t.isValidAddress=function(e,t){return!!e&&(t?"bech32"===t.toLowerCase()?function(e){var t=I(e);if(!t)return!1;if(void 0==={bc:"mainnet",tb:"testnet",bcrt:"regtest"}[t.prefix])return!1;var r=t.words[0];return!(r<0||r>16)}(e):"base58"===t.toLowerCase()&&function(e){var t=T(e);if(!t)return!1;var r=t.length;if(25!==r)return!1;var i=t.readUInt8(0),n=t.slice(r-4,r),o=t.slice(0,r-4),s=P(P(o)).slice(0,4);return!!n.equals(s)&&!!S[i]}(e):this.isValidAddress(e,this.getFormat(e)))},t.getFormat=function(e){if(T(e))return"base58";if(I(e))return"bech32";throw new Error("Invalid address")},e}(),B=function(e){function t(){return e.apply(this,arguments)||this}return m(t,e),t}(A),C=function(e){function t(t){var r,i;return(i=e.call(this,t)||this).networks=((r={})[exports.Network.MAINNET]={blockchain:exports.Blockchain.BITCOIN_SV,network:exports.Network.MAINNET,path:"m/44'/236'/0'",config:E.mainnet},r[exports.Network.TESTNET]={blockchain:exports.Blockchain.BITCOIN_SV,network:exports.Network.TESTNET,path:"m/44'/1'/0'",config:E.testnet},r),i.networkConfig=i.networks[t].config,i.defaultPath=i.networks[t].path,i}return m(t,e),t}(A),K=function(e){function t(t){var r,i;return(i=e.call(this,t)||this).networks=((r={})[exports.Network.MAINNET]={blockchain:exports.Blockchain.BITCOIN_CASH,network:exports.Network.MAINNET,path:"m/44'/145'/0'",config:N.mainnet},r[exports.Network.TESTNET]={blockchain:exports.Blockchain.BITCOIN_CASH,network:exports.Network.TESTNET,path:"m/44'/1'/0'",config:N.testnet},r),i.networkConfig=i.networks[t].config,i.defaultPath=i.networks[t].path,i}m(t,e);var r=t.prototype;return r.getAddressFromPublic=function(t,r){var i=e.prototype.getAddressFromPublic.call(this,t),n=f.toCashAddress(i);return"legacy"===r&&(n=i),"bitpay"===r&&(n=f.toBitpayAddress(n)),n},r.isValidAddress=function(e){return f.isValidAddress(e)},t}(A),F=function(e){function t(t){var r,i;return(i=e.call(this,t)||this).networks=((r={})[exports.Network.MAINNET]={blockchain:exports.Blockchain.LITECOIN,network:exports.Network.MAINNET,path:"m/44'/2'/0'",config:y.mainnet},r[exports.Network.TESTNET]={blockchain:exports.Blockchain.LITECOIN,network:exports.Network.TESTNET,path:"m/44'/1'/0'",config:y.testnet},r),i.networkConfig=i.networks[t].config,i.defaultPath=i.networks[t].path,i}return m(t,e),t}(A),M=require("ethereumjs-tx").Transaction,H={bitcoin:B,litecoin:F,bitcoin_sv:C,bitcoin_cash:K,ethereum:function(e){function t(t){var r,i;return(i=e.call(this,t)||this).networks=((r={})[exports.Network.MAINNET]={blockchain:exports.Blockchain.ETHEREUM,network:exports.Network.MAINNET,path:"m/44'/60'/0'",config:N.mainnet},r[exports.Network.TESTNET]={blockchain:exports.Blockchain.ETHEREUM,network:exports.Network.TESTNET,path:"m/44'/1'/0'",config:N.testnet},r),i.networkConfig=i.networks[t].config,i.defaultPath=i.networks[t].path,i.net=t,i}m(t,e);var r=t.prototype;return r.getPublicFromPrivate=function(t){return p.addHexPrefix(e.prototype.getPublicFromPrivate.call(this,t.replace("0x",""),!1))},r.getPrivateKey=function(e){if(e.privateKey)return p.bufferToHex(e.privateKey);throw new Error("Invalid private key")},r.getPublicKey=function(e){return p.addHexPrefix(e)},r.getAddressFromPublic=function(e){var t=p.importPublic(Buffer.from(e.replace("0x",""),"hex")),r=p.publicToAddress(t),i=p.addHexPrefix(r.toString("hex")),n=p.toChecksumAddress(i);return p.addHexPrefix(n)},r.sign=function(e,t,r){if(void 0===r&&(r=!0),r){var i=this.net===exports.Network.MAINNET?"mainnet":"ropsten",n=JSON.parse(e),o=new M(n,{chain:i}),s=Buffer.from(t.replace("0x",""),"hex");return o.sign(s),"0x"+o.serialize().toString("hex")}var a=p.hashPersonalMessage(Buffer.from(e)),c=p.ecsign(a,Buffer.from(t.replace("0x",""),"hex"));return JSON.stringify({r:c.r.toString("hex"),s:c.s.toString("hex"),v:c.v})},r.checkSign=function(e,t,r){var i=JSON.parse(r);return p.isValidSignature(parseInt(i.v),Buffer.from(i.r,"hex"),Buffer.from(i.s,"hex"))},r.isValidAddress=function(e){return p.isValidAddress(e)},t}(A),eos:function(e){function t(t){var r,i;return(i=e.call(this,t)||this).networks=((r={})[exports.Network.MAINNET]={blockchain:exports.Blockchain.EOS,network:exports.Network.MAINNET,path:"m/44'/194'/0'",config:N.mainnet},r[exports.Network.TESTNET]={blockchain:exports.Blockchain.EOS,network:exports.Network.TESTNET,path:"m/44'/1'/0'",config:N.testnet},r),i.networkConfig=i.networks[t].config,i.defaultPath=i.networks[t].path,i}m(t,e);var r=t.prototype;return r.getPublicFromPrivate=function(e){return l.privateToPublic(e)},r.getPrivateKey=function(e){return l.PrivateKey(e.privateKey).toWif()},r.getPublicKey=function(e){return l.PublicKey(Buffer.from(e,"hex")).toString()},r.getAddressFromPublic=function(e){return e},r.sign=function(e,t){return l.sign(e,t)},r.checkSign=function(e,t,r){return l.verify(r,t,e)},r.isValidAddress=function(e){return new RegExp(/^\e.[a-z1-5]{12}$/g).test(e)},t}(A),ripple:function(e){function t(t){var r,i;return(i=e.call(this,t)||this).networks=((r={})[exports.Network.MAINNET]={blockchain:exports.Blockchain.RIPPLE,network:exports.Network.MAINNET,path:"m/44'/144'/0'",config:N.mainnet},r[exports.Network.TESTNET]={blockchain:exports.Blockchain.RIPPLE,network:exports.Network.TESTNET,path:"m/44'/1'/0'",config:N.testnet},r),i.networkConfig=i.networks[t].config,i.defaultPath=i.networks[t].path,i}m(t,e);var r=t.prototype;return r.getAddressFromPublic=function(e,t){var r=d.deriveAddress(e);if("classic"===t)return r;var i=g.classicAddressToXAddress(r,!1,!1);if(void 0===i)throw new Error("Unknown error deriving address");return i},r.sign=function(e,t){var r=c.ECPair.fromWIF(t,this.networkConfig),i=o("sha256").update(e).digest("hex");if(r.privateKey)return d.sign(i,r.privateKey.toString("hex"));throw Error("Invalid private key")},r.checkSign=function(e,t,r){var i=o("sha256").update(t).digest("hex");return d.verify(i,r,e)},r.isValidAddress=function(e){return g.isValidXAddress(e)||g.isValidClassicAddress(e)},t}(A)};exports.Keys=function(){function e(e,t){if(!H[e])throw new Error("Blockchain "+e+" not implemented yet!");this.lib=new H[e](t)}var t=e.prototype;return t.getMasterFromSeed=function(e,t,r){var i=function(e,t){return s.mnemonicToSeedSync(e,t).toString("hex")}(e,r);return k({seedPhrase:e,seed:i},this.lib.getMasterAddressFromSeed(i,t))},t.isSeed=function(e){return void 0!==e.seedPhrase},t.isMasterPrivate=function(e){return void 0!==e.masterPrivateKey},t.generateSeedPhrase=function(e,t,r,i){void 0===t&&(t=exports.SeedDictionaryLang.ENGLISH);var n=function(e,t){void 0===t&&(t="english");var r=128;if(24===e)r=256;else if(12!==e)throw new Error("Wrong mnemonic length");return s.setDefaultWordlist(t),s.generateMnemonic(r)}(e,t);return this.getMasterFromSeed(n,r,i)},t.getDataFromSeed=function(e,t,r){return this.getMasterFromSeed(e,t,r)},t.derivateKeys=function(e,t){if(this.isSeed(e)){var r=this.getMasterFromSeed(e.seedPhrase,e.password);return this.lib.derivateFromPrivate(r.masterPrivateKey,t)}return this.isMasterPrivate(e)?this.lib.derivateFromPrivate(e.masterPrivateKey,t):this.lib.derivateFromPublic(e.masterPublicKey,t)},t.sign=function(e,t,r){return void 0===r&&(r=!0),this.lib.sign(e,t,r)},t.getPublicFromPrivate=function(e){return this.lib.getPublicFromPrivate(e)},t.getAddressFromPublic=function(e,t){return this.lib.getAddressFromPublic(e,t)},t.checkSign=function(e,t,r){return this.lib.checkSign(e,t,r)},t.checkSeedPhrase=function(e){return s.validateMnemonic(e)},t.getDefaultPaths=function(){return this.lib.getPaths()},t.isValidAddress=function(e,t){return this.lib.isValidAddress(e,t)},t.getFormat=function(e){return this.lib.getFormat(e)},e.decrypt=function(e,t){try{return Promise.resolve(n.SodiumPlus.auto()).then((function(r){var i=o("sha256").update(t).digest("hex"),s=n.CryptographyKey.from(i,"hex"),a=Buffer.from(e.substring(0,48),"hex"),c=Buffer.from(e.substring(48),"hex");return Promise.resolve(r.crypto_secretbox_open(c,a,s)).then((function(e){return e.toString("utf-8")}))}))}catch(e){return Promise.reject(e)}},e.encrypt=function(e,t){try{return Promise.resolve(n.SodiumPlus.auto()).then((function(r){var i=o("sha256").update(t).digest("hex"),s=n.CryptographyKey.from(i,"hex");return Promise.resolve(r.randombytes_buf(24)).then((function(t){return Promise.resolve(r.crypto_secretbox(e,t,s)).then((function(e){return t.toString("hex")+e.toString("hex")}))}))}))}catch(e){return Promise.reject(e)}},e}();
//# sourceMappingURL=crypto-api-keys-lib.cjs.production.min.js.map
