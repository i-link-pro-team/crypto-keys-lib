"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e,t,r,i,n=require("sodium-plus"),o=(e=require("create-hash"))&&"object"==typeof e&&"default"in e?e.default:e,s=require("bip39"),a=require("bitcoinjs-lib"),c=require("bip32"),u=require("bchaddrjs"),h=require("ethereumjs-util"),f=require("eosjs-ecc"),p=require("ripple-keypairs"),l=require("ripple-address-codec");function d(){return(d=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e}).apply(this,arguments)}function g(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,e.__proto__=t}(t=exports.Blockchain||(exports.Blockchain={})).BITCOIN="bitcoin",t.ETHEREUM="ethereum",t.EOS="eos",t.BITCOIN_CASH="bitcoin_cash",t.BITCOIN_SV="bitcoin_sv",t.LITECOIN="litecoin",t.RIPPLE="ripple",(r=exports.Network||(exports.Network={})).MAINNET="mainnet",r.TESTNET="testnet",(i=exports.SeedDictionaryLang||(exports.SeedDictionaryLang={})).ENGLISH="english",i.JAPANESE="japanese",i.SPANISH="spanish",i.CHINESE_SIMPLE="chinese_simple",i.CHINESE_TRADITIONAL="chinese_traditional",i.FRENCH="french",i.ITALIAN="italian",i.KOREAN="korean",i.CZECH="czech";var k=function(e,t){if(e<0)throw Error("Skip must be greater or equal than zero");if(t<1)throw Error("Limit must be greater than zero");return Array.from({length:t},(function(t,r){return r+e+1}))},m=function(e){var t=e.split("/");return t.pop(),t.push("{index}"),t.join("/")},b=function(e){return e.split("/").filter((function(e){return"m"===e||-1!=e.indexOf("'")})).join("/")},v={mainnet:{messagePrefix:"Bitcoin Signed Message:\n",bech32:"bc",bip32:{public:76067358,private:76066276},pubKeyHash:0,scriptHash:5,wif:128},regtest:{messagePrefix:"Bitcoin Signed Message:\n",bech32:"bcrt",bip32:{public:70617039,private:70615956},pubKeyHash:111,scriptHash:196,wif:239},testnet:{messagePrefix:"Bitcoin Signed Message:\n",bech32:"tb",bip32:{public:70617039,private:70615956},pubKeyHash:111,scriptHash:196,wif:239}},x={mainnet:{messagePrefix:"Litecoin Signed Message:\n",bech32:"ltc",bip32:{public:76067358,private:76066276},pubKeyHash:48,scriptHash:50,wif:176},testnet:{messagePrefix:"Litecoin Signed Message:\n",bech32:"tltc",bip32:{public:70617039,private:70615956},pubKeyHash:111,scriptHash:196,wif:239}},P={mainnet:{messagePrefix:"unused",bech32:"bsv",bip32:{public:76067358,private:76066276},pubKeyHash:0,scriptHash:5,wif:128},testnet:{messagePrefix:"unused",bech32:"bsvtest",bip32:{public:70617039,private:70615956},pubKeyHash:111,scriptHash:196,wif:128}},w=function(){function e(e){var t;this.networks=((t={})[exports.Network.MAINNET]={blockchain:exports.Blockchain.BITCOIN,network:exports.Network.MAINNET,path:"m/44'/0'/0'/0/0",config:v.mainnet},t[exports.Network.TESTNET]={blockchain:exports.Blockchain.BITCOIN,network:exports.Network.TESTNET,path:"m/44'/1'/0'/0/0",config:v.testnet},t),this.networkConfig=this.networks[e].config,this.defaultPath=this.networks[e].path}var t=e.prototype;return t.getPaths=function(){return Object.values(this.networks).map((function(e){return{blockchain:e.blockchain,network:e.network,path:e.path}}))},t.deriveRecursive=function(e,t){if(t.length){var r=t[0],i=t.slice(1);return this.deriveRecursive(e.derive(r),i)}return e},t.getPrivateKey=function(e){return e.toWIF()},t.getPublicKey=function(e){return e},t.derivateFromPrivate=function(e,t){var r=this,i=c.fromBase58(e,this.networkConfig),n=k(t.skip,t.limit),o=m(t.path||this.defaultPath);return n.map((function(e){var t=o.replace("{index}",e.toString()),n=i.derivePath(t);return{path:t,address:r.getAddressFromPublic(r.getPublicKey(n.publicKey.toString("hex"))),publicKey:r.getPublicKey(n.publicKey.toString("hex")),privateKey:r.getPrivateKey(n)}}))},t.derivateFromPublic=function(e,t){var r=this,i=c.fromBase58(e,this.networkConfig),n=k(t.skip,t.limit),o=m(t.path||this.defaultPath);return n.map((function(e){var t=o.replace("{index}",e.toString()),n=t.replace(b(o),"").split("/").filter((function(e){return e})).map((function(e){return parseInt(e)})),s=r.deriveRecursive(i,n);return{path:t,address:r.getAddressFromPublic(r.getPublicKey(s.publicKey.toString("hex"))),publicKey:r.getPublicKey(s.publicKey.toString("hex"))}}))},t.sign=function(e,t){var r=a.ECPair.fromWIF(t,this.networkConfig),i=o("sha256").update(e).digest("hex");return r.sign(Buffer.from(i,"hex")).toString("hex")},t.checkSign=function(e,t,r){var i=a.ECPair.fromPublicKey(Buffer.from(e,"hex"),{network:this.networkConfig}),n=o("sha256").update(t).digest("hex");return i.verify(Buffer.from(n,"hex"),Buffer.from(r,"hex"))},t.getMasterAddressFromSeed=function(e,t){var r=c.fromSeed(Buffer.from(e,"hex"),this.networkConfig),i=r.derivePath(b(t||this.defaultPath));return{masterPrivateKey:r.toBase58(),masterPublicKey:r.neutered().toBase58(),masterAccountPrivateKey:i.toBase58(),masterAccountPublicKey:i.neutered().toBase58()}},t.getPublicFromPrivate=function(e,t){return void 0===t&&(t=!0),(t?a.ECPair.fromWIF(e,this.networkConfig):a.ECPair.fromPrivateKey(Buffer.from(e,"hex"))).publicKey.toString("hex")},t.getAddressFromPublic=function(e,t){var r,i;return t&&"bech32"===t?null!==(i=a.payments.p2wpkh({pubkey:Buffer.from(e,"hex"),network:this.networkConfig}).address)&&void 0!==i?i:"":null!==(r=a.payments.p2pkh({pubkey:Buffer.from(e,"hex"),network:this.networkConfig}).address)&&void 0!==r?r:""},e}(),N=function(e){function t(){return e.apply(this,arguments)||this}return g(t,e),t}(w),y=function(e){function t(t){var r,i;return(i=e.call(this,t)||this).networks=((r={})[exports.Network.MAINNET]={blockchain:exports.Blockchain.BITCOIN_SV,network:exports.Network.MAINNET,path:"m/44'/236'/0'/0/0",config:P.mainnet},r[exports.Network.TESTNET]={blockchain:exports.Blockchain.BITCOIN_SV,network:exports.Network.TESTNET,path:"m/44'/1'/0'/0/0",config:P.testnet},r),i.networkConfig=i.networks[t].config,i.defaultPath=i.networks[t].path,i}return g(t,e),t}(w),E=function(e){function t(t){var r,i;return(i=e.call(this,t)||this).networks=((r={})[exports.Network.MAINNET]={blockchain:exports.Blockchain.BITCOIN_CASH,network:exports.Network.MAINNET,path:"m/44'/145'/0'/0/0",config:v.mainnet},r[exports.Network.TESTNET]={blockchain:exports.Blockchain.BITCOIN_CASH,network:exports.Network.TESTNET,path:"m/44'/1'/0'/0/0",config:v.testnet},r),i.networkConfig=i.networks[t].config,i.defaultPath=i.networks[t].path,i}return g(t,e),t.prototype.getAddressFromPublic=function(t,r){var i=e.prototype.getAddressFromPublic.call(this,t),n=u.toCashAddress(i);return"legacy"===r&&(n=i),"bitpay"===r&&(n=u.toBitpayAddress(n)),n},t}(w),S={bitcoin:N,litecoin:function(e){function t(t){var r,i;return(i=e.call(this,t)||this).networks=((r={})[exports.Network.MAINNET]={blockchain:exports.Blockchain.LITECOIN,network:exports.Network.MAINNET,path:"m/44'/2'/0'/0/0",config:x.mainnet},r[exports.Network.TESTNET]={blockchain:exports.Blockchain.LITECOIN,network:exports.Network.TESTNET,path:"m/44'/1'/0'/0/0",config:x.testnet},r),i.networkConfig=i.networks[t].config,i.defaultPath=i.networks[t].path,i}return g(t,e),t}(w),bitcoin_sv:y,bitcoin_cash:E,ethereum:function(e){function t(t){var r,i;return(i=e.call(this,t)||this).networks=((r={})[exports.Network.MAINNET]={blockchain:exports.Blockchain.ETHEREUM,network:exports.Network.MAINNET,path:"m/44'/60'/0'/0/0",config:v.mainnet},r[exports.Network.TESTNET]={blockchain:exports.Blockchain.ETHEREUM,network:exports.Network.TESTNET,path:"m/44'/1'/0'/0/0",config:v.testnet},r),i.networkConfig=i.networks[t].config,i.defaultPath=i.networks[t].path,i}g(t,e);var r=t.prototype;return r.getPublicFromPrivate=function(t){return h.addHexPrefix(e.prototype.getPublicFromPrivate.call(this,t.replace("0x",""),!1))},r.getPrivateKey=function(e){if(e.privateKey)return h.bufferToHex(e.privateKey);throw new Error("Invalid private key")},r.getPublicKey=function(e){return h.addHexPrefix(e)},r.getAddressFromPublic=function(e){var t=h.importPublic(Buffer.from(e.replace("0x",""),"hex")),r=h.publicToAddress(t),i=h.addHexPrefix(r.toString("hex")),n=h.toChecksumAddress(i);return h.addHexPrefix(n)},r.sign=function(e,t){var r=h.hashPersonalMessage(Buffer.from(e)),i=h.ecsign(r,Buffer.from(t.replace("0x",""),"hex"));return JSON.stringify({r:i.r.toString("hex"),s:i.s.toString("hex"),v:i.v})},r.checkSign=function(e,t,r){var i=JSON.parse(r);return h.isValidSignature(parseInt(i.v),Buffer.from(i.r,"hex"),Buffer.from(i.s,"hex"))},t}(w),eos:function(e){function t(t){var r,i;return(i=e.call(this,t)||this).networks=((r={})[exports.Network.MAINNET]={blockchain:exports.Blockchain.EOS,network:exports.Network.MAINNET,path:"m/44'/194'/0'/0/0",config:v.mainnet},r[exports.Network.TESTNET]={blockchain:exports.Blockchain.EOS,network:exports.Network.TESTNET,path:"m/44'/1'/0'/0/0",config:v.testnet},r),i.networkConfig=i.networks[t].config,i.defaultPath=i.networks[t].path,i}g(t,e);var r=t.prototype;return r.getPublicFromPrivate=function(e){return f.privateToPublic(e)},r.getPrivateKey=function(e){return f.PrivateKey(e.privateKey).toWif()},r.getPublicKey=function(e){return f.PublicKey(Buffer.from(e,"hex")).toString()},r.getAddressFromPublic=function(e){return e},r.sign=function(e,t){return f.sign(e,t)},r.checkSign=function(e,t,r){return f.verify(r,t,e)},t}(w),ripple:function(e){function t(t){var r,i;return(i=e.call(this,t)||this).networks=((r={})[exports.Network.MAINNET]={blockchain:exports.Blockchain.RIPPLE,network:exports.Network.MAINNET,path:"m/44'/144'/0'/0/0",config:v.mainnet},r[exports.Network.TESTNET]={blockchain:exports.Blockchain.RIPPLE,network:exports.Network.TESTNET,path:"m/44'/1'/0'/0/0",config:v.testnet},r),i.networkConfig=i.networks[t].config,i.defaultPath=i.networks[t].path,i}g(t,e);var r=t.prototype;return r.getAddressFromPublic=function(e,t){var r=p.deriveAddress(e);if("classic"===t)return r;var i=l.classicAddressToXAddress(r,!1,!1);if(void 0===i)throw new Error("Unknown error deriving address");return i},r.sign=function(e,t){var r=a.ECPair.fromWIF(t,this.networkConfig),i=o("sha256").update(e).digest("hex");if(r.privateKey)return p.sign(i,r.privateKey.toString("hex"));throw Error("Invalid private key")},r.checkSign=function(e,t,r){var i=o("sha256").update(t).digest("hex");return p.verify(i,r,e)},t}(w)};exports.Keys=function(){function e(e,t){if(!S[e])throw new Error("Blockchain "+e+" not implemented yet!");this.lib=new S[e](t)}var t=e.prototype;return t.getMasterFromSeed=function(e,t,r){var i=function(e,t){return s.mnemonicToSeedSync(e,t).toString("hex")}(e,r);return d({seedPhrase:e,seed:i},this.lib.getMasterAddressFromSeed(i,t))},t.isSeed=function(e){return void 0!==e.seedPhrase},t.isMasterPrivate=function(e){return void 0!==e.masterPrivateKey},t.generateSeedPhrase=function(e,t,r,i){void 0===t&&(t=exports.SeedDictionaryLang.ENGLISH);var n=function(e,t){void 0===t&&(t="english");var r=128;if(24===e)r=256;else if(12!==e)throw new Error("Wrong mnemonic length");return s.setDefaultWordlist(t),s.generateMnemonic(r)}(e,t);return this.getMasterFromSeed(n,r,i)},t.getDataFromSeed=function(e,t,r){return this.getMasterFromSeed(e,t,r)},t.derivateKeys=function(e,t){if(this.isSeed(e)){var r=this.getMasterFromSeed(e.seedPhrase,e.password);return this.lib.derivateFromPrivate(r.masterPrivateKey,t)}return this.isMasterPrivate(e)?this.lib.derivateFromPrivate(e.masterPrivateKey,t):this.lib.derivateFromPublic(e.masterPublicKey,t)},t.sign=function(e,t){return this.lib.sign(e,t)},t.getPublicFromPrivate=function(e){return this.lib.getPublicFromPrivate(e)},t.getAddressFromPublic=function(e,t){return this.lib.getAddressFromPublic(e,t)},t.checkSign=function(e,t,r){return this.lib.checkSign(e,t,r)},t.checkSeedPhrase=function(e){return s.validateMnemonic(e)},t.getDefaultPaths=function(){return this.lib.getPaths()},e.decrypt=function(e,t){try{return Promise.resolve(n.SodiumPlus.auto()).then((function(r){var i=o("sha256").update(t).digest("hex"),s=n.CryptographyKey.from(i,"hex"),a=Buffer.from(e.substring(0,48),"hex"),c=Buffer.from(e.substring(48),"hex");return Promise.resolve(r.crypto_secretbox_open(c,a,s)).then((function(e){return e.toString("utf-8")}))}))}catch(e){return Promise.reject(e)}},e.encrypt=function(e,t){try{return Promise.resolve(n.SodiumPlus.auto()).then((function(r){var i=o("sha256").update(t).digest("hex"),s=n.CryptographyKey.from(i,"hex");return Promise.resolve(r.randombytes_buf(24)).then((function(t){return Promise.resolve(r.crypto_secretbox(e,t,s)).then((function(e){return t.toString("hex")+e.toString("hex")}))}))}))}catch(e){return Promise.reject(e)}},e}();
//# sourceMappingURL=crypto-api-keys-lib.cjs.production.min.js.map
