"use strict";function e(e){return e&&"object"==typeof e&&"default"in e?e.default:e}Object.defineProperty(exports,"__esModule",{value:!0});var t,r,n,i=require("sodium-plus"),o=e(require("create-hash")),s=require("bip39"),a=e(require("base-x")),c=require("bitcoinjs-lib"),u=require("bip32"),f=e(require("bech32")),h=require("bchaddrjs"),p=require("ethereumjs-util"),l=require("eosjs-ecc"),d=require("ripple-keypairs"),g=require("ripple-address-codec");function k(){return(k=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function m(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,e.__proto__=t}function b(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function v(e,t){var r;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return b(e,void 0);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?b(e,void 0):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0;return function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}return(r=e[Symbol.iterator]()).next.bind(r)}(t=exports.Blockchain||(exports.Blockchain={})).BITCOIN="bitcoin",t.ETHEREUM="ethereum",t.EOS="eos",t.BITCOIN_CASH="bitcoin_cash",t.BITCOIN_SV="bitcoin_sv",t.LITECOIN="litecoin",t.RIPPLE="ripple",t.DOGECOIN="dogecoin",(r=exports.Network||(exports.Network={})).MAINNET="mainnet",r.TESTNET="testnet",(n=exports.SeedDictionaryLang||(exports.SeedDictionaryLang={})).ENGLISH="english",n.JAPANESE="japanese",n.SPANISH="spanish",n.CHINESE_SIMPLE="chinese_simple",n.CHINESE_TRADITIONAL="chinese_traditional",n.FRENCH="french",n.ITALIAN="italian",n.KOREAN="korean",n.CZECH="czech";var w=function(e,t){if(e<0)throw Error("Skip must be greater or equal than zero");if(t<1)throw Error("Limit must be greater than zero");return Array.from({length:t},(function(t,r){return r+e+1}))},x=function(e){var t=e.split("/");return t.pop(),t.push("{index}"),t.join("/")},y=function(e){return e.split("/").filter((function(e){return"m"===e||-1!=e.indexOf("'")})).join("/")},N=a("123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"),P=function(e){return Buffer.from(o("sha256").update(e).digest())},E={mainnet:{messagePrefix:"Bitcoin Signed Message:\n",bech32:"bc",bip32:{public:76067358,private:76066276},pubKeyHash:0,scriptHash:5,wif:128},regtest:{messagePrefix:"Bitcoin Signed Message:\n",bech32:"bcrt",bip32:{public:70617039,private:70615956},pubKeyHash:111,scriptHash:196,wif:239},testnet:{messagePrefix:"Bitcoin Signed Message:\n",bech32:"tb",bip32:{public:70617039,private:70615956},pubKeyHash:111,scriptHash:196,wif:239}},S={mainnet:{messagePrefix:"Litecoin Signed Message:\n",bech32:"ltc",bip32:{public:76067358,private:76066276},pubKeyHash:48,scriptHash:50,wif:176},testnet:{messagePrefix:"Litecoin Signed Message:\n",bech32:"tltc",bip32:{public:70617039,private:70615956},pubKeyHash:111,scriptHash:196,wif:239}},T={mainnet:{messagePrefix:"Dogecoin Signed Message:\n",bech32:"xdg",bip32:{public:49990397,private:49988504},pubKeyHash:30,scriptHash:22,wif:158},testnet:{messagePrefix:"Dogecoin Signed Message:\n",bech32:"xdg",bip32:{public:70617039,private:70615956},pubKeyHash:113,scriptHash:196,wif:241}},I={mainnet:{messagePrefix:"unused",bech32:"bsv",bip32:{public:76067358,private:76066276},pubKeyHash:0,scriptHash:5,wif:128},testnet:{messagePrefix:"unused",bech32:"bsvtest",bip32:{public:70617039,private:70615956},pubKeyHash:111,scriptHash:196,wif:128}},A={0:{type:"p2pkh",network:"mainnet"},48:{type:"p2pkh",network:"mainnet"},111:{type:"p2pkh",network:"testnet"},5:{type:"p2sh",network:"mainnet"},196:{type:"p2sh",network:"testnet"}},B=function(e){try{return N.decode(e)}catch(e){return null}},C=function(e){try{return f.decode(e)}catch(e){return null}},K=function(){function e(e){var t;this.networks=((t={})[exports.Network.MAINNET]={blockchain:exports.Blockchain.BITCOIN,network:exports.Network.MAINNET,path:"m/44'/0'/0'",config:E.mainnet},t[exports.Network.TESTNET]={blockchain:exports.Blockchain.BITCOIN,network:exports.Network.TESTNET,path:"m/44'/1'/0'",config:E.testnet},t),this.networkConfig=this.networks[e].config,this.defaultPath=this.networks[e].path}var t=e.prototype;return t.getPaths=function(){return Object.values(this.networks).map((function(e){return{blockchain:e.blockchain,network:e.network,path:e.path+"/0/0"}}))},t.deriveRecursive=function(e,t){if(t.length){var r=t[0],n=t.slice(1);return this.deriveRecursive(e.derive(r),n)}return e},t.getPrivateKey=function(e){return e.toWIF()},t.getPublicKey=function(e){return e},t.derivateFromPrivate=function(e,t){var r=this,n=u.fromBase58(e,this.networkConfig),i=w(t.skip,t.limit),o=x(t.path||"0/0");return i.map((function(e){var t=o.replace("{index}",e.toString()),i=n.derivePath(t);return{path:t,address:r.getAddressFromPublic(r.getPublicKey(i.publicKey.toString("hex"))),publicKey:r.getPublicKey(i.publicKey.toString("hex")),privateKey:r.getPrivateKey(i)}}))},t.derivateFromPublic=function(e,t){var r=this,n=u.fromBase58(e,this.networkConfig),i=w(t.skip,t.limit),o=x(t.path||"0/0");return i.map((function(e){var t=o.replace("{index}",e.toString()),i=t.replace(y(o),"").split("/").filter((function(e){return e})).map((function(e){return parseInt(e)})),s=r.deriveRecursive(n,i);return{path:t,address:r.getAddressFromPublic(r.getPublicKey(s.publicKey.toString("hex"))),publicKey:r.getPublicKey(s.publicKey.toString("hex"))}}))},t.sign=function(e,t,r){if(void 0===r&&(r=!0),r){var n,i;try{n=JSON.parse(e),i=JSON.parse(t)}catch(e){throw new Error("Invalid data or key, must be json string")}for(var s,a=new c.Psbt({network:this.networkConfig}),u=v(n.inputs);!(s=u()).done;){var f=s.value;f.type.includes("witness")?a.addInput({hash:f.txId,index:f.n,witnessUtxo:{script:Buffer.from(f.scriptPubKeyHex,"hex"),value:+f.value}}):a.addInput({hash:f.txId,index:f.n,nonWitnessUtxo:Buffer.from(f.hex,"hex")})}for(var h,p=v(n.outputs);!(h=p()).done;){var l=h.value;a.addOutput({address:l.address,value:+l.amount})}for(var d,g=v(n.inputs.entries());!(d=g()).done;){var k=d.value,m=k[0],b=c.ECPair.fromWIF(i[k[1].address],this.networkConfig);a.signInput(m,b),a.validateSignaturesOfInput(m)}return a.finalizeAllInputs(),a.extractTransaction().toHex()}var w=c.ECPair.fromWIF(t,this.networkConfig),x=o("sha256").update(e).digest("hex");return w.sign(Buffer.from(x,"hex")).toString("hex")},t.checkSign=function(e,t,r){var n=c.ECPair.fromPublicKey(Buffer.from(e,"hex"),{network:this.networkConfig}),i=o("sha256").update(t).digest("hex");return n.verify(Buffer.from(i,"hex"),Buffer.from(r,"hex"))},t.getMasterAddressFromSeed=function(e,t){var r=u.fromSeed(Buffer.from(e,"hex"),this.networkConfig),n=r.derivePath(y(t||this.defaultPath));return{masterPrivateKey:r.toBase58(),masterPublicKey:r.neutered().toBase58(),masterAccountPrivateKey:n.toBase58(),masterAccountPublicKey:n.neutered().toBase58()}},t.getPublicFromPrivate=function(e,t){return void 0===t&&(t=!0),(t?c.ECPair.fromWIF(e,this.networkConfig):c.ECPair.fromPrivateKey(Buffer.from(e,"hex"))).publicKey.toString("hex")},t.getAddressFromPublic=function(e,t){var r,n;return t&&"bech32"===t?null!==(n=c.payments.p2wpkh({pubkey:Buffer.from(e,"hex"),network:this.networkConfig}).address)&&void 0!==n?n:"":null!==(r=c.payments.p2pkh({pubkey:Buffer.from(e,"hex"),network:this.networkConfig}).address)&&void 0!==r?r:""},t.isValidAddress=function(e,t){return!!e&&(t?"bech32"===t.toLowerCase()?function(e){var t=C(e);if(!t)return!1;if(void 0==={bc:"mainnet",tb:"testnet",bcrt:"regtest"}[t.prefix])return!1;var r=t.words[0];return!(r<0||r>16)}(e):"base58"===t.toLowerCase()&&function(e){var t=B(e);if(!t)return!1;var r=t.length;if(25!==r)return!1;var n=t.readUInt8(0),i=t.slice(r-4,r),o=t.slice(0,r-4),s=P(P(o)).slice(0,4);return!!i.equals(s)&&!!A[n]}(e):this.isValidAddress(e,this.getFormat(e)))},t.getFormat=function(e){if(B(e))return"base58";if(C(e))return"bech32";throw new Error("Invalid address")},e}(),M=function(e){function t(){return e.apply(this,arguments)||this}return m(t,e),t}(K),F=function(e){function t(t){var r,n;return(n=e.call(this,t)||this).networks=((r={})[exports.Network.MAINNET]={blockchain:exports.Blockchain.BITCOIN_SV,network:exports.Network.MAINNET,path:"m/44'/236'/0'",config:I.mainnet},r[exports.Network.TESTNET]={blockchain:exports.Blockchain.BITCOIN_SV,network:exports.Network.TESTNET,path:"m/44'/1'/0'",config:I.testnet},r),n.networkConfig=n.networks[t].config,n.defaultPath=n.networks[t].path,n}return m(t,e),t}(K),H=function(e){function t(t){var r,n;return(n=e.call(this,t)||this).networks=((r={})[exports.Network.MAINNET]={blockchain:exports.Blockchain.BITCOIN_CASH,network:exports.Network.MAINNET,path:"m/44'/145'/0'",config:E.mainnet},r[exports.Network.TESTNET]={blockchain:exports.Blockchain.BITCOIN_CASH,network:exports.Network.TESTNET,path:"m/44'/1'/0'",config:E.testnet},r),n.networkConfig=n.networks[t].config,n.defaultPath=n.networks[t].path,n}m(t,e);var r=t.prototype;return r.getAddressFromPublic=function(t,r){var n=e.prototype.getAddressFromPublic.call(this,t),i=h.toCashAddress(n);return"legacy"===r&&(i=n),"bitpay"===r&&(i=h.toBitpayAddress(i)),i},r.isValidAddress=function(e){return h.isValidAddress(e)},t}(K),O=function(e){function t(t){var r,n;return(n=e.call(this,t)||this).networks=((r={})[exports.Network.MAINNET]={blockchain:exports.Blockchain.LITECOIN,network:exports.Network.MAINNET,path:"m/44'/2'/0'",config:S.mainnet},r[exports.Network.TESTNET]={blockchain:exports.Blockchain.LITECOIN,network:exports.Network.TESTNET,path:"m/44'/1'/0'",config:S.testnet},r),n.networkConfig=n.networks[t].config,n.defaultPath=n.networks[t].path,n}return m(t,e),t}(K),_=function(e){function t(t){var r,n;return(n=e.call(this,t)||this).networks=((r={})[exports.Network.MAINNET]={blockchain:exports.Blockchain.DOGECOIN,network:exports.Network.MAINNET,path:"m/44'/3'/0'",config:T.mainnet},r[exports.Network.TESTNET]={blockchain:exports.Blockchain.DOGECOIN,network:exports.Network.TESTNET,path:"m/44'/1'/0'",config:T.testnet},r),n.networkConfig=n.networks[t].config,n.defaultPath=n.networks[t].path,n}return m(t,e),t}(K),j=require("ethereumjs-tx").Transaction,L={bitcoin:M,litecoin:O,bitcoin_sv:F,bitcoin_cash:H,ethereum:function(e){function t(t){var r,n;return(n=e.call(this,t)||this).networks=((r={})[exports.Network.MAINNET]={blockchain:exports.Blockchain.ETHEREUM,network:exports.Network.MAINNET,path:"m/44'/60'/0'",config:E.mainnet},r[exports.Network.TESTNET]={blockchain:exports.Blockchain.ETHEREUM,network:exports.Network.TESTNET,path:"m/44'/1'/0'",config:E.testnet},r),n.networkConfig=n.networks[t].config,n.defaultPath=n.networks[t].path,n.net=t,n}m(t,e);var r=t.prototype;return r.getPublicFromPrivate=function(t){return p.addHexPrefix(e.prototype.getPublicFromPrivate.call(this,t.replace("0x",""),!1))},r.getPrivateKey=function(e){if(e.privateKey)return p.bufferToHex(e.privateKey);throw new Error("Invalid private key")},r.getPublicKey=function(e){return p.addHexPrefix(e)},r.getAddressFromPublic=function(e){var t=p.importPublic(Buffer.from(e.replace("0x",""),"hex")),r=p.publicToAddress(t),n=p.addHexPrefix(r.toString("hex")),i=p.toChecksumAddress(n);return p.addHexPrefix(i)},r.sign=function(e,t,r){if(void 0===r&&(r=!0),r){var n=this.net===exports.Network.MAINNET?"mainnet":"ropsten",i=JSON.parse(e),o=new j(i,{chain:n}),s=Buffer.from(t.replace("0x",""),"hex");return o.sign(s),"0x"+o.serialize().toString("hex")}var a=p.hashPersonalMessage(Buffer.from(e)),c=p.ecsign(a,Buffer.from(t.replace("0x",""),"hex"));return JSON.stringify({r:c.r.toString("hex"),s:c.s.toString("hex"),v:c.v})},r.checkSign=function(e,t,r){var n=JSON.parse(r);return p.isValidSignature(parseInt(n.v),Buffer.from(n.r,"hex"),Buffer.from(n.s,"hex"))},r.isValidAddress=function(e){return p.isValidAddress(e)},t}(K),eos:function(e){function t(t){var r,n;return(n=e.call(this,t)||this).networks=((r={})[exports.Network.MAINNET]={blockchain:exports.Blockchain.EOS,network:exports.Network.MAINNET,path:"m/44'/194'/0'",config:E.mainnet},r[exports.Network.TESTNET]={blockchain:exports.Blockchain.EOS,network:exports.Network.TESTNET,path:"m/44'/1'/0'",config:E.testnet},r),n.networkConfig=n.networks[t].config,n.defaultPath=n.networks[t].path,n}m(t,e);var r=t.prototype;return r.getPublicFromPrivate=function(e){return l.privateToPublic(e)},r.getPrivateKey=function(e){return l.PrivateKey(e.privateKey).toWif()},r.getPublicKey=function(e){return l.PublicKey(Buffer.from(e,"hex")).toString()},r.getAddressFromPublic=function(e){return e},r.sign=function(e,t){return l.sign(e,t)},r.checkSign=function(e,t,r){return l.verify(r,t,e)},r.isValidAddress=function(e){return new RegExp(/^\e.[a-z1-5]{12}$/g).test(e)},t}(K),ripple:function(e){function t(t){var r,n;return(n=e.call(this,t)||this).networks=((r={})[exports.Network.MAINNET]={blockchain:exports.Blockchain.RIPPLE,network:exports.Network.MAINNET,path:"m/44'/144'/0'",config:E.mainnet},r[exports.Network.TESTNET]={blockchain:exports.Blockchain.RIPPLE,network:exports.Network.TESTNET,path:"m/44'/1'/0'",config:E.testnet},r),n.networkConfig=n.networks[t].config,n.defaultPath=n.networks[t].path,n}m(t,e);var r=t.prototype;return r.getAddressFromPublic=function(e,t){var r=d.deriveAddress(e);if("classic"===t)return r;var n=g.classicAddressToXAddress(r,!1,!1);if(void 0===n)throw new Error("Unknown error deriving address");return n},r.sign=function(e,t){var r=c.ECPair.fromWIF(t,this.networkConfig),n=o("sha256").update(e).digest("hex");if(r.privateKey)return d.sign(n,r.privateKey.toString("hex"));throw Error("Invalid private key")},r.checkSign=function(e,t,r){var n=o("sha256").update(t).digest("hex");return d.verify(n,r,e)},r.isValidAddress=function(e){return g.isValidXAddress(e)||g.isValidClassicAddress(e)},t}(K),dogecoin:_};exports.Keys=function(){function e(e,t){if(!L[e])throw new Error("Blockchain "+e+" not implemented yet!");this.lib=new L[e](t)}var t=e.prototype;return t.getMasterFromSeed=function(e,t,r){var n=function(e,t){return s.mnemonicToSeedSync(e,t).toString("hex")}(e,r);return k({seedPhrase:e,seed:n},this.lib.getMasterAddressFromSeed(n,t))},t.isSeed=function(e){return void 0!==e.seedPhrase},t.isMasterPrivate=function(e){return void 0!==e.masterPrivateKey},t.generateSeedPhrase=function(e,t,r,n){void 0===t&&(t=exports.SeedDictionaryLang.ENGLISH);var i=function(e,t){void 0===t&&(t="english");var r=128;if(24===e)r=256;else if(12!==e)throw new Error("Wrong mnemonic length");return s.setDefaultWordlist(t),s.generateMnemonic(r)}(e,t);return this.getMasterFromSeed(i,r,n)},t.getDataFromSeed=function(e,t,r){return this.getMasterFromSeed(e,t,r)},t.derivateKeys=function(e,t){if(this.isSeed(e)){var r=this.getMasterFromSeed(e.seedPhrase,e.password);return this.lib.derivateFromPrivate(r.masterPrivateKey,t)}return this.isMasterPrivate(e)?this.lib.derivateFromPrivate(e.masterPrivateKey,t):this.lib.derivateFromPublic(e.masterPublicKey,t)},t.sign=function(e,t,r){return void 0===r&&(r=!0),this.lib.sign(e,t,r)},t.getPublicFromPrivate=function(e){return this.lib.getPublicFromPrivate(e)},t.getAddressFromPublic=function(e,t){return this.lib.getAddressFromPublic(e,t)},t.checkSign=function(e,t,r){return this.lib.checkSign(e,t,r)},t.checkSeedPhrase=function(e){return s.validateMnemonic(e)},t.getDefaultPaths=function(){return this.lib.getPaths()},t.isValidAddress=function(e,t){return this.lib.isValidAddress(e,t)},t.getFormat=function(e){return this.lib.getFormat(e)},e.decrypt=function(e,t){try{return Promise.resolve(i.SodiumPlus.auto()).then((function(r){var n=o("sha256").update(t).digest("hex"),s=i.CryptographyKey.from(n,"hex"),a=Buffer.from(e.substring(0,48),"hex"),c=Buffer.from(e.substring(48),"hex");return Promise.resolve(r.crypto_secretbox_open(c,a,s)).then((function(e){return e.toString("utf-8")}))}))}catch(e){return Promise.reject(e)}},e.encrypt=function(e,t){try{return Promise.resolve(i.SodiumPlus.auto()).then((function(r){var n=o("sha256").update(t).digest("hex"),s=i.CryptographyKey.from(n,"hex");return Promise.resolve(r.randombytes_buf(24)).then((function(t){return Promise.resolve(r.crypto_secretbox(e,t,s)).then((function(e){return t.toString("hex")+e.toString("hex")}))}))}))}catch(e){return Promise.reject(e)}},e}();
//# sourceMappingURL=crypto-api-keys-lib.cjs.production.min.js.map
